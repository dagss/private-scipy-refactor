from bento.commands.hooks \
    import \
        pre_build, post_configure

@pre_build
def mybuild(ctx):
    bld = ctx.yaku_build_ctx
    ldir = ctx.local_node.path_from(ctx.top_node)

    env = {"PYEXT_SHLINKFLAGS": bld.env["FC_RUNTIME_LDFLAGS"][:],
           "PYEXT_LIBS": ["arpack"],
           "PYEXT_LIBDIR": [ldir]}
    for flag in bld.env["LAPACK"]:
        var = env.get("PYEXT_%s" % flag, [])
        var.extend(bld.env["LAPACK"][flag][:])
    ctx.register_environment("_arpack", env)
